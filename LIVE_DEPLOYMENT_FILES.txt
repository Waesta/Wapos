================================================================================
WAPOS LIVE DEPLOYMENT - EVENTS, SECURITY & HR MODULES
================================================================================
Date: December 17, 2025
Version: 1.0.0
Modules: Events & Banquet Management, Security Management, HR & Employee Management
================================================================================

âš ï¸ CRITICAL: BACKUP YOUR DATABASE FIRST!
Run: mysqldump -u [username] -p [database_name] > backup_$(date +%Y%m%d).sql

================================================================================
STEP 1: UPLOAD THESE FILES TO YOUR LIVE SERVER
================================================================================

ğŸ“ DATABASE MIGRATIONS (Upload to: /database/migrations/)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. 020_events_banquet_management.sql     [MODIFIED - Fixed foreign keys]
2. 021_security_management.sql           [MODIFIED - Fixed foreign keys]
3. 022_enhanced_hr_employee.sql          [NEW]
4. 023_add_new_user_roles.sql            [NEW]
5. 024_accounting_integration_fix.sql    [NEW]

ğŸ“ SERVICE CLASSES (Upload to: /app/Services/)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
6. EventsService.php                     [NEW - Complete events logic]
7. SecurityService.php                   [NEW - Complete security logic]
8. HRService.php                         [NEW - Complete HR logic]

ğŸ“ API ENDPOINTS (Upload to: /api/)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
9. events-api.php                        [MODIFIED - Added service details]
10. security-api.php                     [NEW - Complete security API]
11. hr-api.php                           [NEW - Complete HR API]

ğŸ“ FRONTEND PAGES (Upload to: / root folder)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
12. events.php                           [NEW - Complete events UI]
13. security.php                         [MODIFIED - Added patrol modal]
14. hr-employees.php                     [MODIFIED - Fixed payroll button]

ğŸ“ CONFIGURATION (Verify these exist - should already be there)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
15. includes/module-catalog.php          [VERIFY - Should have new modules]
16. includes/header.php                  [VERIFY - Should have navigation]

================================================================================
STEP 2: RUN SQL MIGRATIONS (IN ORDER!)
================================================================================

Connect to your database:
mysql -u [username] -p [database_name]

Then run each migration file:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MIGRATION 1: Events & Banquet Management (10 tables)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
SOURCE /path/to/database/migrations/020_events_banquet_management.sql;

Expected Output: Query OK, 0 rows affected (multiple times)
Creates: event_venues, event_types, event_bookings, event_services, 
         event_booking_services, event_payments, event_setup_requirements,
         event_feedback, event_documents, event_activity_log

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MIGRATION 2: Security Management (11 tables)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
SOURCE /path/to/database/migrations/021_security_management.sql;

Expected Output: Query OK, 0 rows affected (multiple times)
Creates: security_personnel, security_shifts, security_posts, security_schedule,
         security_patrol_routes, security_patrol_logs, security_incidents,
         security_visitor_log, security_equipment, security_training,
         security_handover_notes

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MIGRATION 3: HR & Employee Management (15 tables)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
SOURCE /path/to/database/migrations/022_enhanced_hr_employee.sql;

Expected Output: Query OK, 0 rows affected (multiple times)
Creates: hr_departments, hr_positions, hr_employees, hr_salary_history,
         hr_payroll_runs, hr_payroll_details, hr_leave_types, hr_leave_requests,
         hr_performance_cycles, hr_performance_reviews, hr_employee_documents,
         hr_disciplinary_actions, hr_training_records, hr_exit_interviews,
         hr_employee_benefits

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MIGRATION 4: User Roles Update                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
SOURCE /path/to/database/migrations/023_add_new_user_roles.sql;

Expected Output: Query OK, 0 rows affected
Adds roles: security_manager, security_staff, hr_manager, hr_staff, 
           banquet_coordinator

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MIGRATION 5: Accounting Integration                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
SOURCE /path/to/database/migrations/024_accounting_integration_fix.sql;

Expected Output: Query OK, 0 rows affected
Adds: transaction_id to event_payments, expense_transaction_id to hr_payroll_runs

================================================================================
STEP 3: VERIFY DATABASE TABLES CREATED
================================================================================

Run these verification queries:

-- Check Events tables (should return 10)
SELECT COUNT(*) as event_tables 
FROM information_schema.tables 
WHERE table_schema = DATABASE() 
AND table_name LIKE 'event_%';

-- Check Security tables (should return 11)
SELECT COUNT(*) as security_tables 
FROM information_schema.tables 
WHERE table_schema = DATABASE() 
AND table_name LIKE 'security_%';

-- Check HR tables (should return 15)
SELECT COUNT(*) as hr_tables 
FROM information_schema.tables 
WHERE table_schema = DATABASE() 
AND table_name LIKE 'hr_%';

-- Total new tables: 36

-- Check sample data loaded
SELECT COUNT(*) FROM event_venues;          -- Should be 3
SELECT COUNT(*) FROM event_types;           -- Should be 5
SELECT COUNT(*) FROM security_shifts;       -- Should be 6
SELECT COUNT(*) FROM security_posts;        -- Should be 8
SELECT COUNT(*) FROM hr_departments;        -- Should be 5

================================================================================
STEP 4: TEST THE MODULES
================================================================================

ğŸ”¹ TEST EVENTS MODULE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. Navigate to: https://yourdomain.com/wapos/events.php
2. Verify dashboard loads (no 400 errors in console)
3. Click "New Booking" - modal should open
4. Click "Manage Venues" - modal should show 3 venues
5. Create a test booking
6. Click "Add Service" on a booking
7. Click "Record Payment" on a booking
8. Verify payment creates accounting transaction:
   SELECT * FROM transactions WHERE description LIKE '%Event Payment%' LIMIT 1;

ğŸ”¹ TEST SECURITY MODULE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. Navigate to: https://yourdomain.com/wapos/security.php
2. Verify dashboard loads (no 400 errors in console)
3. Click "Add Personnel" - modal should open
4. Click "Schedule Shift" - modal should open
5. Click "Report Incident" - modal should open
6. Click "Start Patrol" - modal should open (NOT a placeholder!)
7. Click "Log Visitor" - modal should open

ğŸ”¹ TEST HR MODULE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. Navigate to: https://yourdomain.com/wapos/hr-employees.php
2. Verify dashboard loads (no 400 errors in console)
3. Click "Add Employee" - modal should open
4. Click "Process Payroll" - modal should open
5. Create a test payroll run
6. Verify payroll can create accounting expense

================================================================================
STEP 5: ASSIGN USER ROLES
================================================================================

Update user roles for staff who need access:

-- Make a user an Events Manager
UPDATE users SET role = 'banquet_coordinator' WHERE id = [user_id];

-- Make a user a Security Manager
UPDATE users SET role = 'security_manager' WHERE id = [user_id];

-- Make a user an HR Manager
UPDATE users SET role = 'hr_manager' WHERE id = [user_id];

-- View all available roles
SELECT DISTINCT role FROM users;

================================================================================
WHAT'S INCLUDED (FEATURES)
================================================================================

âœ… EVENTS & BANQUET MANAGEMENT
   â€¢ Venue management (3 sample venues)
   â€¢ Event type categorization (5 types)
   â€¢ Booking management with status tracking
   â€¢ Service add-ons (10+ services)
   â€¢ Payment recording with accounting integration
   â€¢ Customer management
   â€¢ Event coordinator assignment
   â€¢ Contract management
   â€¢ Activity logging

âœ… SECURITY MANAGEMENT
   â€¢ Personnel management
   â€¢ Shift scheduling (6 shifts)
   â€¢ Security posts (8 posts)
   â€¢ Patrol route management (4 routes)
   â€¢ Patrol logging with checkpoints
   â€¢ Incident reporting
   â€¢ Visitor logging
   â€¢ Equipment tracking
   â€¢ Training records
   â€¢ Handover notes

âœ… HR & EMPLOYEE MANAGEMENT
   â€¢ Department management (5 departments)
   â€¢ Position management (10+ positions)
   â€¢ Employee records
   â€¢ Salary history tracking
   â€¢ Payroll processing with accounting integration
   â€¢ Leave management (3 leave types)
   â€¢ Performance reviews
   â€¢ Document management
   â€¢ Disciplinary actions
   â€¢ Training records
   â€¢ Exit interviews
   â€¢ Benefits tracking

âœ… ACCOUNTING INTEGRATION
   â€¢ Event payments â†’ Income transactions
   â€¢ Payroll runs â†’ Expense transactions
   â€¢ Automatic transaction creation
   â€¢ Full audit trail

================================================================================
IMPORTANT NOTES
================================================================================

âš ï¸  FOREIGN KEY FIX
All foreign keys referencing users and customers tables have been corrected
to INT UNSIGNED to match existing schema. This was the critical fix.

âš ï¸  NO PLACEHOLDERS
All features are fully implemented. No "coming soon" messages.

âš ï¸  SAMPLE DATA
All migrations include production-ready sample data for immediate use.

âš ï¸  PERMISSIONS
Module access is role-based. Assign appropriate roles to users.

âš ï¸  BROWSER CACHE
After deployment, users should clear browser cache (Ctrl+F5).

================================================================================
ROLLBACK PROCEDURE (IF NEEDED)
================================================================================

If something goes wrong:

1. Restore database from backup:
   mysql -u [username] -p [database_name] < backup_[timestamp].sql

2. Remove uploaded files:
   rm events.php security.php hr-employees.php
   rm api/events-api.php api/security-api.php api/hr-api.php
   rm app/Services/EventsService.php
   rm app/Services/SecurityService.php
   rm app/Services/HRService.php

================================================================================
SUCCESS INDICATORS
================================================================================

âœ… All 36 tables created successfully
âœ… No 400 errors in browser console
âœ… Dashboard stats load on all modules
âœ… All modals open and close correctly
âœ… Sample data visible in dropdowns
âœ… API endpoints return success: true
âœ… Payments create accounting transactions
âœ… Payroll creates accounting expenses

================================================================================
SUPPORT & TROUBLESHOOTING
================================================================================

Check logs if issues occur:
â€¢ PHP errors: /var/log/php_errors.log
â€¢ MySQL errors: /var/log/mysql/error.log
â€¢ Browser console: F12 â†’ Console tab

Common issues:
â€¢ 400 errors â†’ Migrations not run
â€¢ Foreign key errors â†’ Run migrations in correct order
â€¢ Permission denied â†’ Check user roles
â€¢ Blank page â†’ Check PHP error log

================================================================================
DEPLOYMENT CHECKLIST
================================================================================

PRE-DEPLOYMENT:
â˜ Database backup completed
â˜ Files backup completed
â˜ PHP version >= 7.4 verified
â˜ MySQL version >= 5.7 verified

DEPLOYMENT:
â˜ All 14 files uploaded
â˜ All 5 migrations run successfully
â˜ 36 tables verified created
â˜ Sample data verified loaded

POST-DEPLOYMENT:
â˜ Events module tested
â˜ Security module tested
â˜ HR module tested
â˜ User roles assigned
â˜ Browser cache cleared
â˜ Error logs checked

================================================================================
END OF DEPLOYMENT INSTRUCTIONS
================================================================================

Estimated deployment time: 30-45 minutes
Files to upload: 14 files
SQL migrations: 5 files
New database tables: 36 tables
Sample data: Included in all migrations

For questions or issues, refer to the detailed documentation files included
in your WAPOS installation directory.
